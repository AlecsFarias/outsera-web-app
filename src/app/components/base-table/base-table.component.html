<div class="table-card">
  <div class="table-header">
    <div class="header-content">
      <h2 class="table-title">{{ title }}</h2>
      <div class="search-container" *ngIf="showSearch">
        <input
          [type]="searchType"
          class="search-input"
          [(ngModel)]="searchValue"
          [placeholder]="searchPlaceholder"
          (keyup.enter)="handleSearch()"
        />
        <button class="search-button" (click)="handleSearch()">
          <i class="search-icon">üîç</i>
        </button>
      </div>
    </div>
  </div>

  @if (isMultiple) { @for (data of data; track $index) {
  <div class="table-content">
    <div class="table-subtitle" *ngIf="subtitles && subtitles.length > $index">
      {{ subtitles[$index] }}
    </div>

    <div class="table-container">
      <table class="data-table">
        <thead>
          <tr>
            <th *ngFor="let column of columns" [style.width]="column.width">
              <span>{{ column.label }}</span>
            </th>
          </tr>
          <tr *ngIf="showColumnSearch" class="column-search-row">
            <th *ngFor="let column of columns" class="column-search-cell">
              <div class="column-search-container" *ngIf="column.searchable">
                <!-- Text search -->
                <input
                  *ngIf="!column.searchType || column.searchType === 'text'"
                  type="text"
                  class="column-search-input"
                  [placeholder]="column.searchPlaceholder || 'Search...'"
                  [(ngModel)]="columnSearchValues[column.key]"
                  (input)="
                    handleColumnSearch(
                      column,
                      columnSearchValues[column.key] || ''
                    )
                  "
                />

                <!-- Number search -->
                <input
                  *ngIf="column.searchType === 'number'"
                  type="number"
                  class="column-search-input"
                  [placeholder]="column.searchPlaceholder || 'Search...'"
                  [(ngModel)]="columnSearchValues[column.key]"
                  (input)="
                    handleColumnSearch(
                      column,
                      columnSearchValues[column.key] || ''
                    )
                  "
                />

                <!-- Select search -->
                <select
                  *ngIf="column.searchType === 'select'"
                  class="column-search-select"
                  [(ngModel)]="columnSearchValues[column.key]"
                  (change)="
                    handleColumnSearch(
                      column,
                      columnSearchValues[column.key] || ''
                    )
                  "
                >
                  <option value="">
                    {{ column.searchPlaceholder || "All" }}
                  </option>
                  <option
                    *ngFor="let option of column.searchOptions"
                    [value]="option.value"
                  >
                    {{ option.label }}
                  </option>
                </select>
              </div>
            </th>
          </tr>
        </thead>
        <tbody>
          <tr *ngIf="loading" class="loading-row">
            <td [attr.colspan]="columns.length" class="loading-cell">
              <div class="loading-spinner">
                <div class="spinner"></div>
                <span>Carregando...</span>
              </div>
            </td>
          </tr>
          <tr *ngIf="!loading && data.length === 0" class="empty-row">
            <td [attr.colspan]="columns.length" class="empty-cell">
              {{ emptyMessage }}
            </td>
          </tr>
          <tr *ngFor="let row of data; index as i" class="data-row">
            <td *ngFor="let column of columns">
              {{ getCellValue(row, column) }}
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  } } @else {
  <div class="table-content">
    <div class="table-container">
      <table class="data-table">
        <thead>
          <tr>
            <th *ngFor="let column of columns" [style.width]="column.width">
              <span>{{ column.label }}</span>
            </th>
          </tr>
          <tr *ngIf="showColumnSearch" class="column-search-row">
            <th *ngFor="let column of columns" class="column-search-cell">
              <div class="column-search-container" *ngIf="column.searchable">
                <!-- Text search -->
                <input
                  *ngIf="!column.searchType || column.searchType === 'text'"
                  type="text"
                  class="column-search-input"
                  [placeholder]="column.searchPlaceholder || 'Search...'"
                  [(ngModel)]="columnSearchValues[column.key]"
                  (input)="
                    handleColumnSearch(
                      column,
                      columnSearchValues[column.key] || ''
                    )
                  "
                />

                <!-- Number search -->
                <input
                  *ngIf="column.searchType === 'number'"
                  type="number"
                  class="column-search-input"
                  [placeholder]="column.searchPlaceholder || 'Search...'"
                  [(ngModel)]="columnSearchValues[column.key]"
                  (input)="
                    handleColumnSearch(
                      column,
                      columnSearchValues[column.key] || ''
                    )
                  "
                />

                <!-- Select search -->
                <select
                  *ngIf="column.searchType === 'select'"
                  class="column-search-select"
                  [(ngModel)]="columnSearchValues[column.key]"
                  (change)="
                    handleColumnSearch(
                      column,
                      columnSearchValues[column.key] || ''
                    )
                  "
                >
                  <option value="">
                    {{ column.searchPlaceholder || "All" }}
                  </option>
                  <option
                    *ngFor="let option of column.searchOptions"
                    [value]="option.value"
                  >
                    {{ option.label }}
                  </option>
                </select>
              </div>
            </th>
          </tr>
        </thead>
        <tbody>
          <tr *ngIf="loading" class="loading-row">
            <td [attr.colspan]="columns.length" class="loading-cell">
              <div class="loading-spinner">
                <div class="spinner"></div>
                <span>Carregando...</span>
              </div>
            </td>
          </tr>
          <tr *ngIf="!loading && data.length === 0" class="empty-row">
            <td [attr.colspan]="columns.length" class="empty-cell">
              {{ emptyMessage }}
            </td>
          </tr>
          <tr *ngFor="let row of data; index as i" class="data-row">
            <td *ngFor="let column of columns">
              {{ getCellValue(row, column) }}
            </td>
          </tr>
        </tbody>
      </table>

      <!-- Pagination Controls -->
      <div
        class="pagination-container"
        *ngIf="showPagination && totalPages > 1"
      >
        <div class="pagination-controls">
          <button
            class="pagination-btn first-btn"
            [disabled]="currentPage === 0"
            (click)="handleFirstPage()"
            title="First page"
          >
            ‚èÆ
          </button>

          <button
            class="pagination-btn prev-btn"
            [disabled]="currentPage === 0"
            (click)="handlePreviousPage()"
            title="Previous page"
          >
            ‚óÄ
          </button>

          <div class="pagination-numbers">
            <button
              *ngFor="let page of getVisiblePages()"
              class="pagination-number"
              [class.active]="page === currentPage"
              (click)="handlePageChange(page)"
            >
              {{ page + 1 }}
            </button>
          </div>

          <button
            class="pagination-btn next-btn"
            [disabled]="currentPage === totalPages - 1"
            (click)="handleNextPage()"
            title="Next page"
          >
            ‚ñ∂
          </button>

          <button
            class="pagination-btn last-btn"
            [disabled]="currentPage === totalPages - 1"
            (click)="handleLastPage()"
            title="Last page"
          >
            ‚è≠
          </button>
        </div>
      </div>
    </div>
  </div>
  }
</div>
